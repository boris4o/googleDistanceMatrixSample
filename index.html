<html> 
<head> 
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" /> 
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/> 
<title>Distance Matrix Sample</title> 
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script> 
<script type="text/javascript"> 
 
  var origins = [
    "Adams",
    "Asotin",
    "Benton",
    "Chelan",
    "Clallam",
    "Clark",
    "Columbia",
    "Cowlitz",
    "Douglas",
    "Ferry", /* ONE
    "Franklin",
    "Garfield",
    "Grant",
    "Grays Harbor",
    "Island",
    "Jefferson",
    "King",
    "Kitsap",
    "Kittitas",
    "Lewis",
    "Lincoln",
    "Mason",
    "Okanogan",
    "Pacific",
    "Pend Oreille",
    "Pierce",
    "San Juan",
    "Skagit",
    "Skamania",
    "Snohomish",
    "Spokane",
    "Stevens",
    "Thurston",
    "Walla Walla",
    "Whatcom",
    "Whitman",
    "Yakima",*/
  ];
 
  var destinations = [
    "48.191405, -124.075584",
    "48.149733, -123.147240",
    "48.644388, -122.488747",
    "48.341783, -122.439995",
    "48.069499, -122.295799",
    "48.001547, -122.545738",
    "47.664139, -122.420082",
    "47.409642, -122.331505",
    "47.607367, -122.990799",
    "47.094108, -122.718773",
  ];
 
  var query = {
    origins: origins,
    destinations: destinations,
    travelMode: google.maps.TravelMode.DRIVING,
    unitSystem: google.maps.UnitSystem.IMPERIAL
  };
 
  var dms;
 
  function initialize() {
    
    createTable();
    
    for (var i = 0; i < origins.length; i++) {
      origins[i] += ' WA, USA';
    }
 
    for (var j = 0; j < destinations.length; j++) {
      destinations[j] += '';
    }
 
    dms = new google.maps.DistanceMatrixService();
    
    updateMatrix();
  }
 
  function updateMatrix() {
    dms.getDistanceMatrix(query, function(response, status) {
        if (status == "OK") {
          populateTable(response.rows);
        }else{
            alert(status);
        }
      }
    );
  }
 
  function createTable() {
    var table = document.getElementById('matrix');
    var tr = addRow(table);
    addElement(tr);
    for (var j = 0; j < destinations.length; j++) {
      var td = addElement(tr);
      td.setAttribute("class", "destination");
      td.appendChild(document.createTextNode(destinations[j]));
    }
 
    for (var i = 0; i < origins.length; i++) {
      var tr = addRow(table);
      var td = addElement(tr);
      td.setAttribute("class", "origin");
      td.appendChild(document.createTextNode(origins[i]));
      for (var j = 0; j < destinations.length; j++) {
        var td = addElement(tr, 'element-' + i + '-' + j);
      }
    }
  }
 
  function populateTable(rows) {
    for (var i = 0; i < rows.length; i++) {
      for (var j = 0; j < rows[i].elements.length; j++) {
        var distance = rows[i].elements[j].distance.text;
        var duration = rows[i].elements[j].duration.text;
        var td = document.getElementById('element-' + i + '-' + j);
        td.innerHTML = distance + "<br/>" + duration;
      }
    }
  }
 
  function updateUnits() {
    switch (document.getElementById("units").value) {
      case "km":
        query.unitSystem = google.maps.UnitSystem.METRIC;
        break;
      case "mi":
        query.unitSystem = google.maps.UnitSystem.IMPERIAL;
        break;
    }
    updateMatrix();
  }
 
  function addRow(table) {
    var tr = document.createElement('tr');
    table.appendChild(tr);
    return tr;
  }
 
  function addElement(tr, id) {
    var td = document.createElement('td');
    if (id) {
      td.setAttribute('id', id);
    }
    tr.appendChild(td);
    return td;
  }
</script> 
<style> 
body {
  font-family: sans-serif;
}
 
#container {
  position: absolute;
  width:500px;
  left: 5px;
  top: 5px;
}
 
#matrix {
  font-size: 10px;
  border-collapse: collapse;
}
 
#controls {
  
}
 
.origin,.destination {
  font-weight: bold;
  text-align: center;
  background-color: #e0ffe0;
}
 
td {
  border: 1px solid grey;
  width: 100px;
  cursor: default;
  background-color: #ffffff;
}
  
</style> 
</head> 
<body onload="initialize()"> 
<div id="container"> 
  <div id="controls"> 
    <select id="units" onChange="updateUnits()"> 
      <option value="km">Kilometers</option> 
      <option value="mi" selected="selected">Miles</option> 
    </select> 
  </div> 
  <table id="matrix"></table> 
</div> 
</body> 
</html> 
